buildToolsWeak: [ninja]
buildVarsWeak: [PARALLEL_JOBS]
buildSetup: |
    function ninjaParallel
    {
        Param(
            [Alias("C")]
            [string] $Dir = $null,
            # optional
            [Alias("o")]
            [string[]] $Options=@(),
            # optional
            [Alias("t")]
            [string[]] $Targets=@()
        )

        # set the number of logical cores which can be used for parallel builds
        if($Env:PARALLEL_JOBS) {
            $NOLP = [int]$Env:PARALLEL_JOBS
        }
        else {
            $NOLP = (Get-CimInstance Win32_ComputerSystem).NumberOfLogicalProcessors
        }

        $ninjaArgs = @()
        if ($Dir) {
            $ninjaArgs += '-C'
            $ninjaArgs += $Dir
        }

        $ninjaArgs += '-j'
        $ninjaArgs += $NOLP

        if ($Options) {
            $ninjaArgs += $Options
        }

        if ($Targets) {
            $ninjaArgs += $Targets
        }

        Check-Command {
            ninja @ninjaArgs
        }
    }

    function ninjaSequential
    {
        Param(
            # optional
            [Alias("o")]
            [string[]] $Options=@()
        )

        $ninjaArgs = @(
            '-j', '1'
        )

        if ($Options) {
            $ninjaArgs += $Options
        }

        Check-Command {
            ninja @ninjaArgs
        }
    }

    function ninjaInstall
    {
        Check-Command {
            ninja install
        }
    }
