shared: True

metaEnvironment:
    PKG_VERSION: "25.0.1"

checkoutSCM:
    scm: url
    url: ${JAVA_MIRROR}/java/GA/jdk${PKG_VERSION}/2fbf10d8c78e40bd87641c434705079d/8/GPL/openjdk-${PKG_VERSION}_windows-x64_bin.zip
    digestSHA256: "2bbae75bc31a848b7cb5f297270efb7bef9bba0deeec6a671625563dc090ad69"
    dir: openjdk
    extract: no

buildScript: |
    # create a symlink to avoid wasting memory
    $ArchiveName = $(Get-ChildItem "$($args[0])/openjdk" -File '*.zip')
    New-Item -ItemType SymbolicLink -Force -Path "openjdk.zip"  -Target "$($args[0])/openjdk/$ArchiveName" >$null


packageToolsWeak: [7z]
packageScript: |
    $ArchivPath = "$($args[0])"
    mkdir usr > $null
    Check-Command { 7z x -o"usr" -y $ArchivPath/openjdk.zip }
    # because 7z has not strip option we need to do it ourselves
    $RootFolder = $(Get-ChildItem usr)
    cp -r usr/$RootFolder/* usr -Force
    rm -Recurse usr/$RootFolder

provideTools:
    java:
        path: "usr/bin"
