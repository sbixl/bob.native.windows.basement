diff --git a/CMakeLists.txt b/CMakeLists.txt
index 3c25ab4..50cfaaf 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -107,7 +107,7 @@ if(WIN32)
 		src/getopt.c
 		src/tokenpool-gnu-make-win32.cc
 	)
-	if(MSVC)
+	if( CMAKE_CXX_COMPILER_ID STREQUAL "MSVC" OR CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
 		target_sources(libninja PRIVATE src/minidump-win32.cc)
 	endif()
 else()
