# since we can't build gcc native or cross compiling toolchain on windows we must download pre build binaries
checkoutSCM:
    -
        if: !expr |
            "${AUTOCONF_TARGET}" == "arm-none-eabi"
        scm: url
        url: ${DEVELOPER_ARM_MIRROR}/-/media/Files/downloads/gnu/14.3.rel1/binrel/arm-gnu-toolchain-14.3.rel1-mingw-w64-i686-arm-none-eabi.zip
        digestSHA256: "836ebe51fd71b6542dd7884c8fb2011192464b16c28e4b38fddc9350daba5ee8"
        sslVerify: False
        dir: ${AUTOCONF_TARGET}
        extract: no
    -
        if: !expr |
            "${AUTOCONF_TARGET}" == "arm-none-linux-gnueabihf"
        scm: url
        url:  ${DEVELOPER_ARM_MIRROR}/-/media/Files/downloads/gnu/14.3.rel1/binrel/arm-gnu-toolchain-14.3.rel1-mingw-w64-x86_64-arm-none-linux-gnueabihf.zip
        digestSHA256: "fd0801c9fcb0327978e5f7594f38225b7dec0fd515006c1608f74c0460111312"
        sslVerify: False
        dir: ${AUTOCONF_TARGET}
        extract: no
    -
        if: !expr |
            "${AUTOCONF_TARGET}" == "aarch64-none-elf"
        scm: url
        url:  ${DEVELOPER_ARM_MIRROR}/-/media/Files/downloads/gnu/14.3.rel1/binrel/arm-gnu-toolchain-14.3.rel1-mingw-w64-x86_64-aarch64-none-elf.zip
        digestSHA256: "6b7d0680831feb5e69b3f8b9dc05f633c6a7b543b411f863e0f7bd263413c5a5"
        sslVerify: False
        dir: ${AUTOCONF_TARGET}
        extract: no
    -
        if: !expr |
            "${AUTOCONF_TARGET}" == "aarch64-none-linux-gnu"
        scm: url
        url:  ${DEVELOPER_ARM_MIRROR}/-/media/Files/downloads/gnu/14.3.rel1/binrel/arm-gnu-toolchain-14.3.rel1-mingw-w64-x86_64-aarch64-none-linux-gnu.zip
        digestSHA256: "50ebc89d3d152ee4d115e8f3d38cee050fe4050670fa53c51e92fa2792e6fdcf"
        sslVerify: False
        dir: ${AUTOCONF_TARGET}
        extract: no

buildVars: [AUTOCONF_TARGET]
buildScript: |
    # create a symlink to avoid wasting memory
    $ArchiveName = $(Get-ChildItem "$($args[0])/${Env:AUTOCONF_TARGET}" -File '*.zip')
    New-Item -ItemType SymbolicLink `
             -Force `
             -Path "${Env:AUTOCONF_TARGET}.zip" `
             -Target "$($args[0])/${Env:AUTOCONF_TARGET}/$ArchiveName" >$null

packageToolsWeak: [7z]
packageScript: |
    $ArchivPath = "$($args[0])"
    mkdir usr > $null
    Check-Command { 7z x -o"usr" -y $ArchivPath/${Env:AUTOCONF_TARGET}.zip }
